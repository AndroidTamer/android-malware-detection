# Python Scrips for VirusTotal

One of my experiments is to compare the classifier with the 54 antivirus
supported by VirusTotal. These scripts aim to upload files and retrieve
reports to VirusTotal automatically, making your life easier.

## Dependencies

All the scripts are written in Python. To keep dataset well-organized,
a database management system (DBMS) is necessary. Therefore, PostgreSQL
and its Python adapter Psycopg2 are chosen. Poster is also needed since
the Python standard library do not provide a simple way to upload files
via HTTP.

* Python 2.7
* Psycopg
* Poster

## Usage

The core module ``virustotal.py`` provides two APIs: ``scan_file`` and
``retrieve_report``. The parameter ``vtconfigfile`` in the APIs is the
path to a JSON file containing VirusTotal configuration. You can fill the
column of API key in ``sample_vt_config.json`` and use it.

One of the limitation on VirusTotal is that files sent by the API have the
lowest scanning priority. Therefore, use ``virustotal_batch_scan.py`` to
upload all the files first, and ``virustotal_batch_retrieve_report.py`` to
get the reports later. Besides, to keep the dataset well-organized, a SQL
table is necessary:

```sql
CREATE TABLE apps (
  a_id SERIAL PRIMARY KEY,
  a_name VARCHAR,
  a_path VARCHAR,
  a_vt_sha256 VARCHAR,
  a_vt_report JSON
);
```


